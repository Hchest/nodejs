SELECT
	a.PATIENT_NO,
	a.NAME,
	a.DISCHARGE_DATE,
	b.SD_ITEM_VALUE
FROM
	[dbo].[PAT_VISIT] AS a
	LEFT JOIN [dbo].[PAT_SD_ITEM_RESULT] AS b ON a.PATIENT_NO= b.PATIENT_NO 
WHERE
	a.SD_CODE= 'YXA_O' 
	AND b.SD_ITEM_CODE= 'YXA_O_003'
	AND b.SD_ITEM_VALUE LIKE '上海%'
	AND a.DISCHARGE_DATE>'2016-01-01 00:00:00.000'
	AND a.DISCHARGE_DATE<'2016-12-31 00:00:00.000'